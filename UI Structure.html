<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Solar System – Commit 3</title>
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: system-ui, sans-serif;
    background: #10141d;
    color: #e5e9f0;
  }

  #layout {
    display: flex;
    height: 100vh;
    overflow: hidden;
    max-width: 100vw;
}

  /* Left side: canvases stacked */
  #canvasContainer {
    position: relative;
    flex: 1;
  }

  canvas {
    position: absolute;
    top: 0;
    left: 0;
  }

  /* Right side: controls */
  #controls {
    width: 360px;
    min-width: 360px;
    padding: 20px;
    overflow-y: auto;
    background: #141821;
    border-left: 1px solid #222;
  }

  h3 { margin-bottom: 6px; }
  label { display: block; margin: 8px 0; }
  input[type="range"] { width: 160px; }

  #planet-nav button {
    margin-right: 4px;
    padding: 4px 10px;
  }
</style>
</head>
<body>

<div id="layout">


  <!-- ==================== LEFT SIDE CANVASES ==================== -->
  <div id="canvasContainer">
    <canvas id="starCanvas"></canvas>
    <canvas id="simCanvas"></canvas>
  </div>

  <!-- ==================== RIGHT SIDE CONTROLS ==================== -->
  <div id="controls">

    <!-- ==================== SIMULATION CONTROLS ==================== -->
    <h3>— SIMULATION —</h3>
    <label>Speed:
      <input id="speedSlider" type="range" min="1" max="10" value="5">
      <input id="speedBox" type="number" min="1" max="10" value="5">
      <button id="speedReset">Reset</button>
    </label>

    <label>Zoom:
      <input id="zoomSlider" type="range" min="1" max="6" value="3">
      <input id="zoomBox" type="number" min="1" max="6" value="3">
      <button id="zoomReset">Reset</button>
    </label>

    <button id="pauseBtn" style="margin-top:10px;">Pause</button>


    <!-- ==================== PLANET CONTROLS ==================== -->
    <h3>— PLANET —</h3>

    <label>Name:
      <input id="planetName" type="text">
    </label>

    <label>Color:
      <input id="planetColor" type="color" value="#00aaff">
    </label>

    <label>Radius:
      <input id="planetRadius" type="range" min="0.1" max="5" step="0.1" value="1">
      <input id="planetRadiusBox" type="number" min="0.1" max="5" step="0.1" value="1">
      <button id="radiusReset">Reset</button>
    </label>

    <label>Mass:
      <input id="planetMass" type="range" min="0.1" max="10" step="0.1" value="1">
      <input id="planetMassBox" type="number" min="0.1" max="10" step="0.1" value="1">
      <button id="massReset">Reset</button>
    </label>

    <label>Velocity:
      <input id="planetVelocity" type="range" min="0" max="3" step="0.1" value="1">
      <input id="planetVelocityBox" type="number" min="0" max="3" step="0.1" value="1">
      <button id="velocityReset">Reset</button>
    </label>

    <label>Distance:
      <input id="planetDistance" type="range" min="0.2" max="10" step="0.2" value="1">
      <input id="planetDistanceBox" type="number" min="0.2" max="10" step="0.2" value="1">
      <button id="distanceReset">Reset</button>
    </label>


    <!-- ==================== PLANET NAVIGATION ==================== -->
    <div id="planet-nav" style="margin-top: 10px;">
      <button id="prevBtn">Prev</button>
      <button id="addBtn">Add</button>
      <button id="delBtn">Del</button>
      <button id="nextBtn">Next</button>
    </div>

  </div> <!-- end controls -->

</div> <!-- end layout -->


<script>
/*  ============================================================
    STARFIELD — Twinkling, resizes without losing star positions
    ============================================================ */

const starCanvas = document.getElementById("starCanvas");
const starCtx = starCanvas.getContext("2d");

let stars = [];
const STAR_COUNT = 300;

function resizeCanvases() {
  const container = document.getElementById("canvasContainer");
  const w = container.clientWidth;
  const h = container.clientHeight;

  // Get old width/height before resizing
  const oldW = starCanvas.width;
  const oldH = starCanvas.height;

  // Resize the canvases
  starCanvas.width = w;
  starCanvas.height = h;

  const simCanvas = document.getElementById("simCanvas");
  simCanvas.width = w;
  simCanvas.height = h;

  // If stars already exist, re-map them to new size
  if (stars.length > 0) {
    for (let s of stars) {
      s.x = s.px * w;
      s.y = s.py * h;
    }
  } else {
    generateStars();
  }
}

function generateStars() {
  stars = [];
  const w = starCanvas.width;
  const h = starCanvas.height;

  for (let i = 0; i < STAR_COUNT; i++) {
    const x = Math.random() * w;
    const y = Math.random() * h;

    stars.push({
      // Store the actual pixel position
      x,
      y,

      // AND the position as a percentage for resize stability
      px: x / w,
      py: y / h,

      r: Math.random() * 1.8 + 0.4,
      twinkle: Math.random() * 0.05 + 0.01
    });
  }
}

function drawStars() {
  const w = starCanvas.width;
  const h = starCanvas.height;

  starCtx.clearRect(0, 0, w, h);

  for (let s of stars) {
    // Twinkle
    s.r += (Math.random() - 0.5) * s.twinkle;
    if (s.r < 0.3) s.r = 0.3;
    if (s.r > 2.5) s.r = 2.5;

    // Draw star
    starCtx.beginPath();
    starCtx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
    starCtx.fillStyle = "white";
    starCtx.fill();
  }

  requestAnimationFrame(drawStars);
}

window.addEventListener("resize", resizeCanvases);
window.addEventListener("orientationchange", resizeCanvases);

resizeCanvases();
drawStars();


/* ================================================================
   Set Control Variables
================================================================ */

const speedSlider = document.getElementById("speedSlider");
const speedBox    = document.getElementById("speedBox");
const speedReset  = document.getElementById("speedReset");

const zoomSlider = document.getElementById("zoomSlider");
const zoomBox    = document.getElementById("zoomBox");
const zoomReset  = document.getElementById("zoomReset");

const planetName        = document.getElementById("planetName");
const planetColor       = document.getElementById("planetColor");
const planetRadius      = document.getElementById("planetRadius");
const planetRadiusBox   = document.getElementById("planetRadiusBox");
const radiusReset       = document.getElementById("radiusReset");

const planetMass        = document.getElementById("planetMass");
const planetMassBox     = document.getElementById("planetMassBox");
const massReset         = document.getElementById("massReset");

const planetVelocity     = document.getElementById("planetVelocity");
const planetVelocityBox  = document.getElementById("planetVelocityBox");
const velocityReset      = document.getElementById("velocityReset");

const planetDistance     = document.getElementById("planetDistance");
const planetDistanceBox  = document.getElementById("planetDistanceBox");
const distanceReset      = document.getElementById("distanceReset");

const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");
const addBtn  = document.getElementById("addBtn");
const delBtn  = document.getElementById("delBtn");


/* ================================================================
   Planet + PlanetList Data Model
================================================================ */

class Planet {
  constructor(name, color, radius, mass, velocity, distance) {
    this.name = name;
    this.color = color;
    this.radius = radius;
    this.mass = mass;
    this.velocity = velocity;
    this.distance = distance;
  }
}

class PlanetList {
  constructor() {
    this.planets = [];
    this.currentIndex = 0;
  }

  addPlanet() {
    const baseName = "Earth";
    let count = 1;
    let finalName = baseName;

    // Auto-name: Earth, Earth 2, Earth 3...
    while (this.planets.some(p => p.name === finalName)) {
      count++;
      finalName = `${baseName} ${count}`;
    }

    const newPlanet = new Planet(finalName, "#00aaff", 1, 1, 1, 1);
    this.planets.push(newPlanet);
    this.currentIndex = this.planets.length - 1;
    return newPlanet;
  }

  deleteCurrent() {
    if (this.planets.length <= 1) return; // don't delete last planet
    this.planets.splice(this.currentIndex, 1);
    this.currentIndex = this.currentIndex % this.planets.length;
  }

  // CYCLED navigation
  next() {
    this.currentIndex = (this.currentIndex + 1) % this.planets.length;
  }

  prev() {
    this.currentIndex =
      (this.currentIndex - 1 + this.planets.length) % this.planets.length;
  }

  getCurrent() {
    return this.planets[this.currentIndex];
  }
}


/* ================================================================
   Initialize Planet List
================================================================ */

const planetList = new PlanetList();
planetList.addPlanet(); // start with one default Earth


/* ================================================================
   UI Loading Helper
================================================================ */

function loadPlanetIntoUI() {
  const p = planetList.getCurrent();

  planetName.value = p.name;
  planetColor.value = p.color;
  planetRadius.value = planetRadiusBox.value = p.radius;
  planetMass.value = planetMassBox.value = p.mass;
  planetVelocity.value = planetVelocityBox.value = p.velocity;
  planetDistance.value = planetDistanceBox.value = p.distance;

  // Delete button only disabled if only 1 planet exists
  delBtn.disabled = (planetList.planets.length === 1);
}


/* ================================================================
   Navigation Button Hooks
================================================================ */

prevBtn.onclick = () => {
  planetList.prev();
  loadPlanetIntoUI();
};

nextBtn.onclick = () => {
  planetList.next();
  loadPlanetIntoUI();
};

addBtn.onclick = () => {
  planetList.addPlanet();
  loadPlanetIntoUI();
};

delBtn.onclick = () => {
  planetList.deleteCurrent();
  loadPlanetIntoUI();
};


/* ================================================================
   Sync UI Input → Planet Object
================================================================ */

// name
planetName.oninput = () => {
  planetList.getCurrent().name = planetName.value;
};

// color
planetColor.oninput = () => {
  planetList.getCurrent().color = planetColor.value;
};


/* ===== SIMULATION CONTROLS ===== */

speedSlider.oninput = () => { speedBox.value = speedSlider.value; };
speedBox.oninput    = () => { speedSlider.value = speedBox.value; };

zoomSlider.oninput = () => { zoomBox.value = zoomSlider.value; };
zoomBox.oninput    = () => { zoomSlider.value = zoomBox.value; };


/* ===== PLANET PARAMETER CONTROLS ===== */

// radius
planetRadius.oninput = () => {
  planetRadiusBox.value = planetRadius.value;
  planetList.getCurrent().radius = parseFloat(planetRadius.value);
};
planetRadiusBox.oninput = () => {
  planetRadius.value = planetRadiusBox.value;
  planetList.getCurrent().radius = parseFloat(planetRadiusBox.value);
};

// mass
planetMass.oninput = () => {
  planetMassBox.value = planetMass.value;
  planetList.getCurrent().mass = parseFloat(planetMass.value);
};
planetMassBox.oninput = () => {
  planetMass.value = planetMassBox.value;
  planetList.getCurrent().mass = parseFloat(planetMassBox.value);
};

// velocity
planetVelocity.oninput = () => {
  planetVelocityBox.value = planetVelocity.value;
  planetList.getCurrent().velocity = parseFloat(planetVelocity.value);
};
planetVelocityBox.oninput = () => {
  planetVelocity.value = planetVelocityBox.value;
  planetList.getCurrent().velocity = parseFloat(planetVelocityBox.value);
};

// distance
planetDistance.oninput = () => {
  planetDistanceBox.value = planetDistance.value;
  planetList.getCurrent().distance = parseFloat(planetDistance.value);
};
planetDistanceBox.oninput = () => {
  planetDistance.value = planetDistanceBox.value;
  planetList.getCurrent().distance = parseFloat(planetDistanceBox.value);
};


/* ===== PLANET RESET BUTTONS ===== */

radiusReset.onclick = () => {
  planetRadius.value = planetRadiusBox.value = 1;
  planetList.getCurrent().radius = 1;
};

massReset.onclick = () => {
  planetMass.value = planetMassBox.value = 1;
  planetList.getCurrent().mass = 1;
};

velocityReset.onclick = () => {
  planetVelocity.value = planetVelocityBox.value = 1;
  planetList.getCurrent().velocity = 1;
};

distanceReset.onclick = () => {
  planetDistance.value = planetDistanceBox.value = 1;
  planetList.getCurrent().distance = 1;
};


/* ===== SIMULATION RESET BUTTONS ===== */

speedReset.onclick = () => {
  speedSlider.value = speedBox.value = 5;
};

zoomReset.onclick = () => {
  zoomSlider.value = zoomBox.value = 3;
};

/* ===== PAUSE / PLAY BUTTON ===== */
let isPaused = false;

const pauseBtn = document.getElementById("pauseBtn");
pauseBtn.onclick = () => {
  isPaused = !isPaused;
  pauseBtn.textContent = isPaused ? "Play" : "Pause";
};


/* ================================================================
   Load Initial Planet
================================================================ */

loadPlanetIntoUI();

</script>

</body>
</html>
